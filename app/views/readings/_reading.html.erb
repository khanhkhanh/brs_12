<% unless current_user.nil? %>

  <% if record = current_user.find_reading(book) %>

    <% if record.reading? %>
      <%= link_to t(:reading_button), user_readings_path(book_id: record.book_id, user_id: current_user.id,
        behaviour: Settings.book.reading), method: :patch, remote: true,
        class: "btn btn-primary btn-reading btn-hidden" %>

      <%= link_to t(:read_button), user_readings_path(book_id: record.book_id, user_id: current_user.id,
        behaviour: Settings.book.read), method: :patch, remote: true,
        class: "btn btn-primary btn-read" %>
    <% else %>
      <%= link_to t(:reading_button), user_readings_path(book_id: record.book_id, user_id: current_user.id,
        behaviour: Settings.book.reading), method: :patch, remote: true,
        class: "btn btn-primary btn-reading btn-hidden" %>

      <%= link_to t(:read_button), user_readings_path(book_id: record.book_id, user_id: current_user.id,
        behaviour: Settings.book.read), method: :patch, remote: true,
        class: "btn btn-primary btn-read btn-hidden" %>
    <% end %>

    <%= link_to t(:unread_button), user_readings_path(book_id: record.book_id, user_id: current_user.id),
      method: :delete, remote: true, class: "btn btn-primary btn-unread" %>

  <% else %>

    <%= link_to t(:reading_button), user_readings_path(user_id: current_user.id, book_id: book.id,
      behaviour: Settings.book.reading), method: :post, remote: true, class: "btn btn-primary btn-reading" %>

    <%= link_to t(:read_button), user_readings_path(user_id: current_user.id, book_id: book.id,
      behaviour: Settings.book.read), method: :post, remote: true, class: "btn btn-primary btn-read" %>

    <%= link_to t(:unread_button), "#", class: "btn btn-primary btn-unread btn-hidden" %>

  <% end %>

<% else %>

  <%= link_to t(:reading_button), login_path, class: "btn btn-primary btn-reading" %>

  <%= link_to t(:read_button), login_path, class: "btn btn-primary btn-reading" %>

  <%= link_to t(:unread_button), "#", class: "btn btn-primary btn-unread btn-hidden" %>

<% end %>
